<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaker Submission Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Mulish:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Mulish', sans-serif; }
        h1, h2, h3 { font-family: 'Montserrat', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="password-gate" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300">
        <div class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-sm mx-4">
            <h2 class="text-2xl font-bold mb-4 text-center">Access Portal</h2>
            <p class="text-center text-gray-600 mb-6">Please enter the password to continue.</p>
            <div id="password-error" class="text-red-500 text-center mb-4 font-semibold hidden">Incorrect Password. Please try again.</div>
            <input type="password" id="password-input" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Password">
            <button id="password-submit" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300 mt-4">Enter</button>
        </div>
    </div>

    <main id="main-content" class="container mx-auto p-4 md:p-8 opacity-0 -translate-y-4 transition-all duration-500 hidden">
        <div class="max-w-3xl mx-auto bg-white p-8 rounded-xl shadow-lg">
            
            <header class="text-center mb-10 border-b pb-6">
                <h1 class="text-4xl font-bold text-gray-900">Speaker Submission Portal</h1>
                <p class="text-lg text-gray-600 mt-2">Submit your sermon details and assets here.</p>
            </header>

            <section id="resources" class="mb-10">
                <h2 class="text-2xl font-bold mb-4 border-l-4 border-indigo-500 pl-4">Resources</h2>
                <div class="bg-indigo-50 border border-indigo-200 p-6 rounded-lg space-y-4">
                    <p class="text-gray-700">Please use the following resources to prepare your presentation.</p>
                    <ul class="list-disc list-inside space-y-3">
                        <li><a href="https://drive.google.com/file/d/1_qJqzE2bP0TgShAT1q3y6C2SJHk4V5du/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:text-indigo-800 font-semibold underline">Download PowerPoint Template</a></li>
                        <li><a href="https://fonts.google.com/specimen/Mulish" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:text-indigo-800 font-semibold underline">Download 'Mulish' Font</a></li>
                        <li><a href="https://fonts.google.com/specimen/Montserrat" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:text-indigo-800 font-semibold underline">Download 'Montserrat' Font</a></li>
                    </ul>
                </div>
            </section>

            <section id="submission-form">
                <h2 class="text-2xl font-bold mb-6 border-l-4 border-indigo-500 pl-4">Submission Form</h2>
                <form id="speaker-form" class="space-y-6">
                    <div>
                        <label for="speakerName" class="block text-sm font-medium text-gray-700 mb-1">Speaker Name</label>
                        <input type="text" id="speakerName" name="speakerName" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <div>
                        <label for="sermonTitle" class="block text-sm font-medium text-gray-700 mb-1">Sermon Title</label>
                        <input type="text" id="sermonTitle" name="sermonTitle" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    
                    <div>
                        <label for="sermonDescription" class="block text-sm font-medium text-gray-700 mb-1">Sermon Description (Brief)</label>
                        <textarea id="sermonDescription" name="sermonDescription" rows="4" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>

                    <div>
                        <label for="scriptureReference" class="block text-sm font-medium text-gray-700 mb-1">Primary Scripture Reference(s)</label>
                        <input type="text" id="scriptureReference" name="scriptureReference" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <div>
                        <label for="serviceDate" class="block text-sm font-medium text-gray-700 mb-1">Service Date</label>
                        <input type="date" id="serviceDate" name="serviceDate" required class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <div>
                        <label for="presentationFile" class="block text-sm font-medium text-gray-700 mb-1">Presentation File</label>
                        <p class="text-xs text-gray-500 mb-2">Accepted formats: .ppt, .pptx, .key</p>
                        <input type="file" id="presentationFile" name="presentationFile" accept=".ppt,.pptx,.key" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                    </div>

                    <div>
                        <label for="speakerPhoto" class="block text-sm font-medium text-gray-700 mb-1">Speaker Headshot/Photo</label>
                        <p class="text-xs text-gray-500 mb-2">Accepted formats: .jpg, .jpeg, .png</p>
                        <input type="file" id="speakerPhoto" name="speakerPhoto" accept="image/jpeg,image/png" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                    </div>

                    <div class="pt-4">
                        <button type="submit" id="submit-button" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-md hover:bg-green-700 transition duration-300 text-lg flex items-center justify-center">Submit Information</button>
                    </div>
                </form>
                <div id="status-message" class="mt-6 p-4 rounded-md hidden"></div>
            </section>
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        // --- CONFIGURATION ---
        // 1. Paste the Google Apps Script Web App URL here.
        const googleScriptUrl = "https://script.google.com/macros/s/AKfycbwRvWg_76kNHSGBA-diGXbFi-Ey1zPU279KZzikr2Iq1ryWbI_KETdPmScxJCcOrP06aQ/exec";
        
        // 2. This password must EXACTLY match the PASSWORD variable inside your Google Apps Script file.
        const scriptPassword = "ExcellenceHonorsGod";

        // 3. This is the password users will enter to see the form.
        const correctPassword = "Autumn2025"; 
        // ---------------------

        const passwordGate = document.getElementById('password-gate');
        const passwordInput = document.getElementById('password-input');
        const passwordSubmit = document.getElementById('password-submit');
        const passwordError = document.getElementById('password-error');
        const mainContent = document.getElementById('main-content');
        const serviceDateInput = document.getElementById('serviceDate');
        const speakerForm = document.getElementById('speaker-form');
        const statusMessage = document.getElementById('status-message');
        const submitButton = document.getElementById('submit-button');

        function checkPassword() {
            if (passwordInput.value === correctPassword) {
                passwordGate.classList.add('opacity-0');
                setTimeout(() => { passwordGate.style.display = 'none'; }, 300);
                mainContent.style.display = 'block';
                setTimeout(() => { mainContent.classList.remove('opacity-0', '-translate-y-4'); }, 50);
            } else {
                passwordError.classList.remove('hidden');
                passwordInput.focus();
            }
        }
        
        passwordSubmit.addEventListener('click', checkPassword);
        passwordInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') checkPassword(); });

        function getNextSunday() {
            const d = new Date();
            d.setDate(d.getDate() + (7 - d.getDay()) % 7);
            return d.toISOString().split("T")[0];
        }
        
        serviceDateInput.value = getNextSunday();
        serviceDateInput.min = new Date().toISOString().split("T")[0];

        speakerForm.addEventListener('submit', function(event) {
            event.preventDefault();

            submitButton.disabled = true;
            submitButton.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Submitting...`;
            
            const formData = new FormData(speakerForm);
            // Append the script password for verification on the server
            formData.append('password', scriptPassword);

            fetch(googleScriptUrl, {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json())
            .then(data => {
                statusMessage.classList.remove('hidden', 'bg-red-100', 'text-red-800', 'bg-green-100', 'text-green-800');
                if (data.status === 'success') {
                    statusMessage.textContent = 'Thank you! Your submission has been received successfully.';
                    statusMessage.classList.add('bg-green-100', 'text-green-800');
                    speakerForm.reset();
                    serviceDateInput.value = getNextSunday();
                } else {
                    throw new Error(data.message || 'An unknown error occurred.');
                }
            })
            .catch(error => {
                statusMessage.classList.remove('hidden', 'bg-red-100', 'text-red-800', 'bg-green-100', 'text-green-800');
                statusMessage.textContent = 'Submission failed: ' + error.message;
                statusMessage.classList.add('bg-red-100', 'text-red-800');
            })
            .finally(() => {
                submitButton.disabled = false;
                submitButton.innerHTML = 'Submit Information';
                statusMessage.classList.remove('hidden');
                
                setTimeout(() => {
                    statusMessage.classList.add('hidden');
                }, 6000);
            });
        });
    });
    </script>
</body>
</html>
